# SA Explorer - Star Atlas Fleet Fees Analyzer

A web-based explorer for analyzing Star Atlas SAGE fleet fees and operations.

## ğŸš€ Features

- **Fleet Analysis**: Analyze all fleets (owned and rented) for your profile
- **24h SAGE Fees**: Calculate and track SAGE fees with detailed breakdown by fleet and operation
- **Rental Detection**: Automatic detection and highlighting of rented fleets via SRSLY program
- **Real-time Data**: Access live blockchain data and transaction history
- **Visual Reports**: Pie charts and detailed breakdowns of fees by fleet and operation type
- **Modern Interface**: Clean, responsive dark-themed interface

## ğŸ› ï¸ Tech Stack

- **Backend**: Node.js, Express.js, TypeScript
- **Blockchain**: Solana Web3.js, Star Atlas SAGE SDK
- **Frontend**: Vanilla JavaScript, HTML5, CSS3
- **Development**: tsx for development, TypeScript compilation

## ğŸ“¦ Dependencies

### Core Dependencies
- `@staratlas/sage` - Star Atlas SAGE game SDK
- `@staratlas/data-source` - Data source utilities
- `@staratlas/player-profile` - Player profile management
- `@solana/web3.js` - Solana blockchain interaction
- `@project-serum/anchor` - Solana program framework
- `express` - Web server framework

### Development Dependencies
- `typescript` - Type safety and development
- `tsx` - TypeScript execution for development
- `@types/express` - Express TypeScript definitions
- `@types/node` - Node.js TypeScript definitions

## ğŸš€ Quick Start

### Prerequisites
- Node.js 18+ 
- npm or yarn

### Installation

1. **Navigate to project**:
   ```bash
   cd "d:\sa\SA Explorer"
   ```

2. **Install dependencies**:
   ```bash
   npm install
   ```

3. **Build the project**:
   ```bash
   npm run build
   ```

4. **Start server**:
   ```bash
   npm start
   ```

5. **Open in browser**:
   Navigate to `http://localhost:3000`

### Available Scripts

- `npm run dev` - Start development server with hot reload
- `npm run build` - Build TypeScript to JavaScript
- `npm start` - Start production server (requires build first)

## ğŸ“š API Endpoints

### Profile & Fleet Endpoints
- `POST /api/profile` - Get player profile information
  - Body: `{ "profileId": "AAozfx..." }`
  
- `POST /api/fleets` - Get all fleets (owned + rented via SRSLY)
  - Body: `{ "profileId": "AAozfx..." }`

### Fee Analysis Endpoints
- `POST /api/wallet-sage-fees-detailed` - Get detailed 24h SAGE fee analysis
  - Body: `{ "walletPubkey": "...", "fleetAccounts": [...], "fleetNames": {...}, "fleetRentalStatus": {...}, "hours": 24 }`

### Game Data Endpoints
- `GET /api/game` - Get SAGE game information
- `POST /api/planets` - Get planets at coordinates
  - Body: `{ "x": 0, "y": 0 }`

## ğŸ“ Project Structure

```
SA Explorer/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ index.html         # Main UI
â”‚   â”œâ”€â”€ app.js            # Frontend logic
â”‚   â””â”€â”€ styles.css        # UI styles
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts          # Express server & routes
â”‚   â”œâ”€â”€ examples/
â”‚   â”‚   â”œâ”€â”€ 01-game.ts            # Game data fetching
â”‚   â”‚   â”œâ”€â”€ 02-profile.ts         # Player profile
â”‚   â”‚   â”œâ”€â”€ 03-fleets.ts          # Fleet discovery (owned + SRSLY rentals)
â”‚   â”‚   â”œâ”€â”€ 04-planets.ts         # Planet data
â”‚   â”‚   â”œâ”€â”€ 05-compose-fleet.ts   # Fleet composition
â”‚   â”‚   â””â”€â”€ 06-transactions.ts    # Transaction & fee analysis
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ anchor-setup.ts       # Anchor/Solana connection
â”‚       â””â”€â”€ wallet-setup.ts       # Wallet utilities
â”œâ”€â”€ dist/              # Compiled JavaScript (generated by tsc)
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

## ğŸ”§ Configuration

### Environment Variables (Optional)

The project uses hardcoded defaults but you can override via environment:

```env
PORT=3000
RPC_ENDPOINT=https://mainnet.helius-rpc.com/?api-key=YOUR_KEY
RPC_WEBSOCKET=wss://rpc.helius.xyz/?api-key=YOUR_KEY
WALLET_PATH=D:\sa\star-atlas-cookbook\id.json
```

## ğŸ§ª Development

### Running in Development Mode

```bash
npm run dev
```

The server will start with hot reload enabled at `http://localhost:3000`.

### Building for Production

```bash
npm run build
npm start
```

## ğŸ¨ UI Features

### Fleet Breakdown
- **Rented Fleets**: Automatically highlighted with:
  - Yellow bold fleet name
  - "RENTED" badge
  - Purple left border
  - Sorted to top of list
  
### Charts
- **Fees by Fleet (Top 5)**: Pie chart showing top 5 fleets by fee
- **Fees by Operation (Top 5)**: Pie chart showing top 5 operation types

### Operations Tracked
- Mining, Cargo/Dock, Subwarp, ScanSDU
- Crafting, Starbase operations
- Fleet management, Player profile operations
- Rental operations (AddRental, ChangeRental, etc.)

## ğŸ” Rental Detection

The app uses multiple strategies to detect rented fleets:
1. **SRSLY Program Scan**: Scans SRSLY rental program accounts for fleet references
2. **SAGE SubProfile Check**: Checks fleet.subProfile field
3. **Transaction History**: Analyzes recent wallet transactions

Rented fleets are visually distinguished in the UI for easy identification.

## ğŸ“ License

This project is licensed under the MIT License.

## ğŸ™ Acknowledgments

- Star Atlas team for the SAGE SDK
- Solana Foundation for the blockchain infrastructure
- SRSLY program for fleet rentals

---

**SA Explorer** - Analyze your Star Atlas fleet operations and fees